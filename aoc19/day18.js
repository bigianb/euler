const input = [
"#################################################################################",
"#.........#q..#.......................#.#.....................#...#.............#",
"#.#####.#.###.#.#######.#############.#.#.###################.#.#.#.#######.###.#",
"#...#...#...#.....#...#g#...........#...#.#...........#.O.#...#.#.#...#...#.#...#",
"###.#.#####.#######.#.#.#####.###.#.###.#.#####.#####.#.#.#.###.#F###.#.#.#.#T###",
"#.#.#...#...#.......#...#...#...#.#.#...#.....#...#.#.#.#...#...#...#.#.#...#...#",
"#.#.###.#.###.###########.#.#####.###.#######.#.#.#.#.#.#####.#####.#.#.#########",
"#...#...#.....#...........#.....#.#y..#.#.....#.#.#...#.....#...#...#.#.#.......#",
"#.###.#########.#####.#########.#.#.###.#.#######.#.#######.###.#.###.#.#.#####.#",
"#...#.......#...#.....#.....#.....#.#...#.#.......#.....#.#...#.#.#.#.#.......#.#",
"#.#######.#.#.#########.###.#.#####.#.#.#.###.#########.#.#.#.#.#.#.#.#########.#",
"#.#.....#.#.#.#...#.......#.#.#.#...#.#.#...#.#...#...#...#.#.#.#.#...#.#.......#",
"###.###.###.#.#.#.#.#######.#.#.#.#####.###.#.#.#.###.###.#.#.#.#.###.#.#.#####E#",
"#...#.......#...#...#...#...#...#.#.....#.#...#.#.......#.#.#.#.#...#...#...#...#",
"#.#################.###.#.#######.#.#.###.#####.#########.#.###.###.#.#####.#.###",
"#.......#.....#...#...#.#.......#.#.#...#.................#.#...#.#.#.#.....#...#",
"#.#####.#.###.#.#.###.#.#######.#.#####.#.#########.#######.#.###.#.#.#.#######.#",
"#e#...#.#.#.#.#.#.#...........#.........#.#.......#.....#...#.#...#.#.#.#.C.#...#",
"#.#.###.#.#.#.#.#.#######.#############.#.#.#####.#######.#.#.#.#.#.#.#.#.#.#.###",
"#.#.#...#...#...#...#.....#...#...#.....#.#...#.#.....#...#.#.#.#.#.#.#.#.#.#.#.#",
"#.#.#.#####.#######.#######.#.#.#.#######.###.#.#####.#.#####.#.#.#.###.#.###.#.#",
"#...#.#...#.#.....#...#...#.#...#.......#.#...#...#...#.....#.#.#.#.....#.....#.#",
"###.#.#.#.#.#####.#####.#.#.###########.#.#.###.#.#.###.###.###.#.#######.#####.#",
"#...#...#.#.........#...#...#...#.......#.#.#...#.#.#.#...#.....#...#...#...#...#",
"#.#######.#########.###.#######.#.#########.#.###.#.#.#.#####.###.#.#.#.###.#.#.#",
"#.#.#.....#.......#.#...#.......#.#.#...#...#...#...#...#...#.#...#.#.#...#.#.#.#",
"#.#.#.#####.#####.#.#.###.#######.#.#.#.#.#####.#####.###.#.###.###.#.#####.###Z#",
"#...#.........#...#...#.#.........#..k#.#.#.....#.......#.#...#...#...#.....#...#",
"###############.#.#####.#.#########.###.#.#.#############.###.###.#####.#####.#.#",
"#...N...#...#...#.#...#...#.#...#...#...#.#.............#.#.......#...#.#....b#.#",
"#.#####.#.#.#.###.###.#.###.#.#.#.###.#.#.#############.#.#########.#.#.###.###.#",
"#.#.......#.#...#.....#.#...#.#...#...#.#.#...#.......#.#...#.....#.#.#.....#...#",
"#.#########.###.#######.#.#.#.#####.###.#.#.#.#####.###.###.#.###.#.#.#######.###",
"#.#...V.#.#.H.#.#.......#.#.#.....#...#.#...#.#...#.........#...#...#.......#...#",
"#.#.###.#.###.#.#.#######.#####.#####.###.###.#.#.###.#####.###.#########.#####.#",
"#.....#.#...#.#.#.#.......#.....#...#...#.#...#.#...#.#...#.#...#.......#.....#.#",
"#.#####.#.###.#.#.#######.#.#####.#.###.###.#.#.###.###.#.###.###.#####.###.#.#.#",
"#.#.#...#..a....#...#...#...#.....#...#.#...#.#...#.....#.....#.#.....#..h..#.#.#",
"#.#.#.#############.#.#.#####.#######.#.#.#######.#############.#####.#########A#",
"#...#.................#.......#.............................X.......#...........#",
"#######################################.@.#######################################",
"#.D.....#.....#.......#.....#.........................#.....#.......#.#...#...#.#",
"#.###.#.#.#.#.#.#####.#.###.#.#.#######.#.###########.#.#.#.#.#####.#.#I#.#.#.#.#",
"#i#...#.#.#.#...#.....#.#...#.#x......#.#.#.......#...#.#.#...#.......#.#...#.#.#",
"###.###.###.#.#####.###.#.###.#######.#.#.###.###.#.#.#.#.#####.#######.#####.#.#",
"#...#.......#.#...#.#...#...#.#.#.....#.#.....#.#.#.#.#.#v....#.#...#...#d..#...#",
"#.#######.#####.#.#.#.#####.#.#.#.#####.#######.#.#.###.#####.#.#.###.###.#####.#",
"#.#.....#.#....u#.#.#...#...#...#.#.#...#.#...#...#.#...#.....#.#.#...#.........#",
"#.#.###.#.#.#####.#.###.#.#####.#.#.#.###.#.#.#.###.#.###.#####.#.#.###.#########",
"#.S.#.#.#.#.....#.#...#.#...#...#.#.#.#.#...#.....#.#...#...#.....#...#...#..s..#",
"#.###.#.#.#.#####.#.###.###.#.###.#.#.#.#.#########.#.#####.#########.###.#####.#",
"#.#...#.#.#.#.....#.#...#...#.#.#.#.#...#.....#...#...#...#n..#.P...#.#.#.......#",
"#.#.#.#.###.#.#####.#.###.###.#.#.#.###.#######.#.#####.#.###.#.###.#.#.#######.#",
"#...#.#.....#.....#.#.#...#.....#.#...#.#...#...#.....#.#...#.#.#.#...#.......#.#",
"#####.###########.#.#.###.#######.#.###.#.#.#.#######.#.###.#.#.#.#########.#.#U#",
"#.....#.......#...#.#...#.#.......#.....#.#...#.....#...#.....#.#...........#.#.#",
"#.#########.#.#.###.###.#.#.#######.#####.#####.#.###.#####.###.#.#######.#####.#",
"#.#.......#.#.#.#..w#...#...#...#...#.K.#...#.#.#.....#...#.#...#.#.#...#.#.....#",
"#.#.#####.#.#.#.###.#.#######.###.###.#.#.#.#.#.#######.#.###.###.#.#.#.#.#.#####",
"#...#..p....#.#...#.#...#...#...#.....#.#.#.#.#...#.....#...#...#.#...#...#.....#",
"#.###########.###.#.###.#.#.#R#.#######.#.#.#.###.#.#######.###.#.###.#########.#",
"#.#.......#.....#.#.#...#.#.#.#.......#.#.#.#.....#.#.#.....#.#.#...#.#.......#.#",
"#.#.#####.#######.#.#####M###.#.#####.#.#.#.###.###.#.#.#####.#W#.#.###.#.###.#.#",
"#.#.#.#.........#.#.#...#...#.#...#..m#.#.#...#.#...#.#.#...#j..#.#.#...#.#...#.#",
"#.#.#.#.#######.#.#.#.#.###.#.###.#####.#.###.###.###.#.#.#.#######.#.###.#.###.#",
"#.#.#.....#...#...#...#...#...#...#.....#.#.#.....#...#...#.........#.#...#.Q.#.#",
"#.#.#####.#.#.###########.#.###.#.#.#####.#.#######.#.#####.###.#####.#.#.#####.#",
"#.#.....#.#.#.........#...#.#...#.#.#...#...#.......#.#.#...#.#.#.G...#.#.#...#.#",
"#######.###.#########.#J#####L###.#.#.#.###.###.#.###.#.#.###.#.#.#####.###.#.#.#",
"#.....#.......#...#...#.#...#.#...#...#.#.#...#.#.#.....#.#...#.#.#...#.....#.Y.#",
"#B###.#######.###.#.###.#.#.#.#########.#.###.#.#.#######.#.###.#.#.#############",
"#.#...#...#...#...#...#l..#...#.....#...#.#...#.#.......#.#.....#.#.........#...#",
"#.###.#.#.#.###.#####.#######.#.###.#.###.#.###.#######.#.#####.#.#.###.###.#.###",
"#...#...#.#.....#...#...#...#.#.#.#...#.#.#.#...#.......#.....#.#.#...#.#...#f..#",
"#.#.#####.#.#####.#.###.#.#.#.#.#.#####.#.#.#####.#####.#####.###.#####.#.#####.#",
"#.#.....#.#.#.....#.#...#r#...#.....#...#.#.....#.#...#.#...#..o#.#.....#.#.....#",
"#.#####.#.###.#####.#.#.###########.#.#.#.#####.#.#.###.###.###.#.#.#####.#.#.#.#",
"#...#.#.#.....#z..#...#.#.....#.....#.#.#c....#.#.#...#.....#...#...#....t#.#.#.#",
"###.#.#.#######.#.#######.###.#.#######.#.#.###.#.#.#.#####.#.#######.#######.#.#",
"#.....#.........#...........#...........#.#.......#.#.......#.................#.#",
"#################################################################################"
];

/*
Shortest paths are 136 steps;
one is: a, f, b, j, g, n, h, d, l, o, e, p, c, i, k, m
*/
const example136 = [
"#################",
"#i.G..c...e..H.p#",
"########.########",
"#j.A..b...f..D.o#",
"########@########",
"#k.E..a...g..B.n#",
"########.########",
"#l.F..d...h..C.m#",
"#################"
];

function findStart(inputMap)
{
    let x=0;
    let y=0;
    while (y < inputMap.length){
        let row = inputMap[y];
        for (x=0; x<row.length; ++x){
            if (row[x] == '@'){
                return {x, y};
            }
        }
        ++y;
    }

    return {x, y}
}

function findNeighbours(pos, inputMap)
{
    let neighbours = [];

    if (pos.y > 0 && inputMap[pos.y-1][pos.x] != '#'){
        neighbours.push({x: pos.x, y: pos.y-1})
    }
    if (pos.y+1 < inputMap.length && inputMap[pos.y+1][pos.x] != '#'){
        neighbours.push({x: pos.x, y: pos.y+1})
    }
    if (pos.x > 0 && inputMap[pos.y][pos.x-1] != '#'){
        neighbours.push({x: pos.x-1, y: pos.y})
    }
    if (pos.x+1 < inputMap[pos.y].length && inputMap[pos.y][pos.x+1] != '#'){
        neighbours.push({x: pos.x+1, y: pos.y})
    }
    return neighbours;
}

// Given a start position, a set of held keys and an inputMap, return the keys we can reach and the minimum distance to each one.
function findAvailableKeys(start, keys, inputMap)
{
    // Keep searching until we hit a wall or a locked door.
    let neighbours = findNeighbours(start, inputMap);
    console.log(neighbours);

    return {};
}

// Solves the given map and returns the minimum steps.
function solve(inputMap)
{
    let start = findStart(inputMap);
    console.log("start = " + start);
    let keys = [];
    let availableKeys = findAvailableKeys(start, keys, inputMap);
    console.log(availableKeys);

    return 0;
}

let minSteps = solve(example136);
if (minSteps != 136){
    console.error("Expected 136 steps but got " + minSteps);
}
